- name: Compile AHK v2 Script
  shell: pwsh
  run: |
    $ahk2exe = "C:\AutoHotkey\Compiler\Ahk2Exe.exe"
    $bin     = "C:\AutoHotkey\v2\AutoHotkey64.exe"
    $src     = "$env:GITHUB_WORKSPACE\AutoReSizer.ahk"
    $out     = "$env:GITHUB_WORKSPACE\AutoReSizer.exe"

    Write-Host "AHK2EXE: $ahk2exe"
    Write-Host "BIN:     $bin"
    Write-Host "SRC:     $src"
    Write-Host "OUT:     $out"

    if (!(Test-Path $src)) { throw "Source file not found!" }
    if (!(Test-Path $ahk2exe)) { throw "Ahk2Exe not found!" }
    if (!(Test-Path $bin)) { throw "AutoHotkey64.exe not found!" }

    & $ahk2exe /in "$src" /out "$out" /bin "$bin" /silent

    if (!(Test-Path $out)) {
      throw "Compilation failed â€“ EXE not created"
    }
