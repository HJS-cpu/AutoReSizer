name: Compile AHK v2 Script

on: [push, workflow_dispatch]

jobs:
  compile:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Install AutoHotkey v2
        run: |
          # Install from official source
          choco install autohotkey --version=2.0.11 -y --no-progress
          
      - name: Compile with installed AHK
        shell: cmd
        run: |
          echo Looking for Ahk2Exe...
          where /r C:\ Ahk2Exe.exe
          
          echo Looking for AutoHotkey64.exe...
          where /r C:\ AutoHotkey64.exe
          
          echo Trying to compile...
          "C:\Program Files\AutoHotkey\Compiler\Ahk2Exe.exe" /in "AutoReSizer.ahk" /out "AutoReSizer.exe" /bin "C:\Program Files\AutoHotkey\v2\AutoHotkey64.exe"
          
          if exist "AutoReSizer.exe" (
            echo SUCCESS!
            dir AutoReSizer.exe
          ) else (
            echo FAILED!
            exit 1
          )
          
      - uses: actions/upload-artifact@v4
        with:
          name: AutoReSizer
          path: AutoReSizer.exe
